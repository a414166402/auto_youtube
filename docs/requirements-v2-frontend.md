# YouTube AIè§†é¢‘åˆ¶ä½œå·¥å…· - å‰ç«¯éœ€æ±‚æ–‡æ¡£ V2

## ç‰ˆæœ¬ä¿¡æ¯
- ç‰ˆæœ¬ï¼šV2.0
- æ—¥æœŸï¼š2026-01-11
- çŠ¶æ€ï¼šå¾…å¼€å‘

---

## ä¸€ã€å…¨å±€ä¸»ä½“åº“ç®¡ç†ï¼ˆSettings é¡µé¢æ”¹é€ ï¼‰

### 1.1 åŠŸèƒ½æ¦‚è¿°

å°†å½“å‰åŸºäº IndexedDB/localStorage çš„æœ¬åœ°ä¸»ä½“åº“ç®¡ç†ï¼Œæ”¹ä¸ºè°ƒç”¨åç«¯ API è¿›è¡Œç®¡ç†ã€‚

### 1.2 é¡µé¢è·¯å¾„
`/dashboard/youtube/settings`

### 1.3 æ”¹é€ å†…å®¹

#### 1.3.1 æ•°æ®æºå˜æ›´
| åŸå®ç° | æ–°å®ç° |
|--------|--------|
| IndexedDB å­˜å‚¨ | è°ƒç”¨ `GET /api/youtube/subjects` |
| localStorage ä¿å­˜ | è°ƒç”¨ `POST/PUT/DELETE /api/youtube/subjects` |

#### 1.3.2 API è°ƒç”¨
```typescript
// src/lib/api/youtube.ts æ–°å¢

// è·å–å…¨å±€ä¸»ä½“åˆ—è¡¨
export async function getSubjects(type?: SubjectType): Promise<SubjectListResponse>

// åˆ›å»ºä¸»ä½“
export async function createSubject(data: FormData): Promise<SubjectResponse>

// æ›´æ–°ä¸»ä½“
export async function updateSubject(id: string, data: FormData): Promise<SubjectResponse>

// åˆ é™¤ä¸»ä½“
export async function deleteSubject(id: string): Promise<void>
```

#### 1.3.3 å›¾ç‰‡ä¸Šä¼ é™åˆ¶
- æ–‡ä»¶å¤§å°é™åˆ¶ï¼šâ‰¤ 5MB
- å‰ç«¯æ ¡éªŒï¼Œè¶…å‡ºæ—¶æ˜¾ç¤ºé”™è¯¯æç¤º
- æ”¯æŒæ ¼å¼ï¼šjpg, jpeg, png, webp

#### 1.3.4 UI æ”¹è¿›
- ä¸‰ä¸ª Tab é¡µï¼šè§’è‰²åº“ã€ç‰©å“åº“ã€åœºæ™¯åº“
- æ¯ä¸ªä¸»ä½“å¡ç‰‡ï¼šä»¥åç§°æ˜¾ç¤ºï¼Œæ”¯æŒç¼–è¾‘/ä¿å­˜æ¨¡å¼åˆ‡æ¢
- åŠ¨æ€æ·»åŠ /åˆ é™¤ä¸»ä½“ï¼ˆæ— éœ€æŒ‰é¡ºåºï¼‰
- **æ·»åŠ ä¸»ä½“å¯¹è¯æ¡†**ï¼šç‚¹å‡»"å¢åŠ "æŒ‰é’®å¼¹å‡ºå¯¹è¯æ¡†ï¼Œè¾“å…¥åç§°å’Œä¸Šä¼ å›¾ç‰‡
- **ç¼–è¾‘æ¨¡å¼**ï¼šé»˜è®¤åªè¯»æ˜¾ç¤ºï¼Œç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œä¿å­˜åé€€å‡º

#### 1.3.5 æ·»åŠ ä¸»ä½“æµç¨‹
1. ç‚¹å‡»"å¢åŠ è§’è‰²/ç‰©å“/åœºæ™¯" â†’ å¼¹å‡º `AddSubjectDialog` å¯¹è¯æ¡†
2. ç”¨æˆ·è¾“å…¥åç§°ã€ä¸Šä¼ å›¾ç‰‡
3. ç‚¹å‡»"æ·»åŠ " â†’ è°ƒç”¨ `createSubject(type, name, image)` åˆ›å»º

#### 1.3.6 ç¼–è¾‘ä¸»ä½“æµç¨‹
1. ä¸»ä½“å¡ç‰‡é»˜è®¤æ˜¾ç¤ºåç§°ï¼ˆåªè¯»ï¼‰
2. ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’® â†’ è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œåç§°å˜ä¸ºè¾“å…¥æ¡†
3. ä¿®æ”¹åç§°åç‚¹å‡»"ä¿å­˜" â†’ è°ƒç”¨ `updateSubject(id, name)` ä¿å­˜
4. ä¿å­˜æˆåŠŸåé€€å‡ºç¼–è¾‘æ¨¡å¼

#### 1.3.7 identifier å­—æ®µåºŸå¼ƒè¯´æ˜
- åŸè®¾è®¡ä¸­çš„ A-Z æ ‡è¯†ç¬¦å·²åºŸå¼ƒ
- ä¸»ä½“é€šè¿‡ UUID å”¯ä¸€æ ‡è¯†
- é¡¹ç›®çº§æ˜ å°„ç›´æ¥ä½¿ç”¨ä¸»ä½“ UUID

### 1.4 ç±»å‹å®šä¹‰æ›´æ–°

```typescript
// src/types/youtube.ts æ–°å¢

export type SubjectType = 'character' | 'object' | 'scene';

export interface Subject {
  id: string;           // UUID
  type: SubjectType;
  identifier?: string;  // å·²åºŸå¼ƒï¼Œä¿ç•™å…¼å®¹
  name?: string;
  image_url?: string;
  created_at: string;
  updated_at: string;
}

export interface SubjectListResponse {
  subjects: Subject[];
  total: number;
}
```

### 1.5 åˆ é™¤æ–‡ä»¶
- `src/lib/subject-config.ts` ä¸­çš„ IndexedDB ç›¸å…³ä»£ç å¯ç§»é™¤æˆ–é‡æ„

---

## äºŒã€é¡¹ç›®çº§ä¸»ä½“æ˜ å°„æ”¹é€ 

### 2.1 åŠŸèƒ½æ¦‚è¿°

å°†é¡¹ç›®çº§ä¸»ä½“æ˜ å°„ä» localStorage è¿ç§»åˆ°é¡¹ç›® JSONB çš„ `subject_mappings` å­—æ®µã€‚

### 2.2 å½±å“é¡µé¢
- `/dashboard/youtube/prompts/[projectId]` - æç¤ºè¯ç¼–è¾‘é¡µé¢

### 2.3 æ”¹é€ å†…å®¹

#### 2.3.1 æ•°æ®è¯»å–
```typescript
// åŸå®ç°ï¼šä» localStorage è¯»å–
const mapping = loadProjectSubjectMapping(projectId);

// æ–°å®ç°ï¼šä»é¡¹ç›®æ•°æ®ä¸­è¯»å–
const project = await getProject(projectId);
const mapping = project.data.subject_mappings || {};
```

#### 2.3.2 æ•°æ®ä¿å­˜
```typescript
// åŸå®ç°ï¼šä¿å­˜åˆ° localStorage
saveProjectSubjectMapping(projectId, mapping);

// æ–°å®ç°ï¼šè°ƒç”¨æ›´æ–°é¡¹ç›®æ¥å£
await updateProject(projectId, {
  subject_mappings: mapping
});
```

#### 2.3.3 ä¸»ä½“é€‰æ‹©å™¨
- ä»åç«¯è·å–å…¨å±€ä¸»ä½“åˆ—è¡¨
- æ˜¾ç¤ºä¸»ä½“å›¾ç‰‡ç¼©ç•¥å›¾å’Œåç§°
- é€‰æ‹©åä¿å­˜æ˜ å°„å…³ç³»

### 2.4 ç±»å‹å®šä¹‰æ›´æ–°

```typescript
// src/types/youtube.ts ä¿®æ”¹ ProjectData

export interface ProjectData {
  name: string;
  youtube_url: string;
  status: ProjectStatus;
  aspect_ratio?: AspectRatio;
  current_prompt_version?: string;
  subject_mappings?: Record<string, string>;  // {"è§’è‰²A": "uuid", ...}
  prompt_history?: PromptHistoryVersion[];
  storyboards: Storyboard[];
}
```

---

## ä¸‰ã€æç¤ºè¯å¤šè½®å¯¹è¯å†å²

### 3.1 åŠŸèƒ½æ¦‚è¿°

æ”¯æŒæç¤ºè¯çš„å¤šç‰ˆæœ¬ç®¡ç†ï¼ŒåŒ…æ‹¬ï¼š
- æŸ¥çœ‹å†å²ç‰ˆæœ¬
- åˆ‡æ¢ç‰ˆæœ¬
- ç»§ç»­å¯¹è¯ç”Ÿæˆæ–°ç‰ˆæœ¬
- ä»å†å²ç‰ˆæœ¬é‡æ–°ç”Ÿæˆ

### 3.2 å½±å“é¡µé¢
- `/dashboard/youtube/prompts/[projectId]` - æç¤ºè¯ç¼–è¾‘é¡µé¢

### 3.3 UI è®¾è®¡

#### 3.3.1 ç‰ˆæœ¬é€‰æ‹©å™¨
ä½ç½®ï¼šé¡µé¢å¤´éƒ¨ï¼Œé¡¹ç›®åç§°æ—è¾¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† æç¤ºè¯ç¼–è¾‘                    ç‰ˆæœ¬: [v3 â–¼]  å½“å‰ç‰ˆæœ¬  â”‚
â”‚    å…± 15 ä¸ªåˆ†é•œæç¤ºè¯                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ä¸‹æ‹‰é€‰é¡¹ï¼š
```
v3 (å½“å‰) - 2026-01-10 14:30 - "è®©ç”»é¢æ›´ç§‘å¹»"
v2        - 2026-01-10 12:00 - "å¢åŠ éœ“è™¹ç¯æ•ˆæœ"  
v1        - 2026-01-10 10:00 - "ä¸éœ€è¦ä»»ä½•æ”¹ç¼–"
```

#### 3.3.2 ç‰ˆæœ¬æ“ä½œæŒ‰é’®
ä½ç½®ï¼šé¡µé¢å¤´éƒ¨æ“ä½œåŒº

| æŒ‰é’® | æ˜¾ç¤ºæ¡ä»¶ | åŠŸèƒ½ |
|------|----------|------|
| ç»§ç»­å¯¹è¯ | å§‹ç»ˆæ˜¾ç¤º | åŸºäºå½“å‰ç‰ˆæœ¬ç»§ç»­å¯¹è¯ |
| é‡æ–°ç”Ÿæˆ | æŸ¥çœ‹å†å²ç‰ˆæœ¬æ—¶ | ä»è¯¥ç‰ˆæœ¬é‡æ–°ç”Ÿæˆï¼Œæ¸…é™¤åç»­ç‰ˆæœ¬ |

#### 3.3.3 ç»§ç»­å¯¹è¯å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç»§ç»­å¯¹è¯                            [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½“å‰ç‰ˆæœ¬: v3                            â”‚
â”‚                                         â”‚
â”‚ ä¿®æ”¹æŒ‡ä»¤:                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¯·è®©è§’è‰²è¡¨æƒ…æ›´å¤¸å¼ ï¼Œå¢åŠ æˆå‰§æ€§      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ è¯´æ˜: å°†åŸºäºå½“å‰ç‰ˆæœ¬ç»§ç»­å¯¹è¯ï¼Œç”Ÿæˆ v4   â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç”Ÿæˆæ–°ç‰ˆæœ¬]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.4 é‡æ–°ç”Ÿæˆç¡®è®¤å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡æ–°ç”Ÿæˆç¡®è®¤                        [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ è­¦å‘Š                                 â”‚
â”‚                                         â”‚
â”‚ ä» v2 é‡æ–°ç”Ÿæˆå°†åˆ é™¤ä»¥ä¸‹ç‰ˆæœ¬:           â”‚
â”‚ â€¢ v3 - 2026-01-10 14:30                 â”‚
â”‚                                         â”‚
â”‚ æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼                        â”‚
â”‚                                         â”‚
â”‚ ä¿®æ”¹æŒ‡ä»¤:                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ¢ä¸€ç§å®Œå…¨ä¸åŒçš„é£æ ¼                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç¡®è®¤é‡æ–°ç”Ÿæˆ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 API è°ƒç”¨

```typescript
// src/lib/api/youtube.ts æ–°å¢

// ç»§ç»­å¯¹è¯ç”Ÿæˆ
export async function continuePrompts(
  projectId: string, 
  instruction: string
): Promise<ContinuePromptsResponse>

// é‡æ–°ç”Ÿæˆ
export async function regeneratePrompts(
  projectId: string,
  fromVersion: string,
  instruction: string
): Promise<RegeneratePromptsResponse>

// åˆ‡æ¢ç‰ˆæœ¬
export async function switchPromptVersion(
  projectId: string,
  version: string
): Promise<SwitchVersionResponse>

// è·å–å†å²ç‰ˆæœ¬åˆ—è¡¨
export async function getPromptHistory(
  projectId: string
): Promise<PromptHistoryListResponse>
```

### 3.5 ç±»å‹å®šä¹‰

```typescript
// src/types/youtube.ts æ–°å¢

export interface PromptHistoryVersion {
  version: string;
  created_at: string;
  parent_version?: string;
  instruction: string;
  conversation_history: ConversationMessage[];
  storyboards: PromptHistoryStoryboard[];
}

export interface PromptHistorySummary {
  version: string;
  created_at: string;
  instruction: string;
  storyboard_count: number;
  parent_version?: string;
}

export interface PromptHistoryListResponse {
  current_version: string;
  versions: PromptHistorySummary[];
}

export interface ContinuePromptsResponse {
  success: boolean;
  version: string;
  storyboard_count: number;
  message: string;
}

export interface RegeneratePromptsResponse {
  success: boolean;
  version: string;
  deleted_versions: string[];
  storyboard_count: number;
  message: string;
}
```

---

## å››ã€åˆ†é•œç®¡ç†åŠŸèƒ½

### 4.1 åŠŸèƒ½æ¦‚è¿°

åœ¨æç¤ºè¯ç¼–è¾‘é¡µé¢æ”¯æŒï¼š
- åˆ é™¤åˆ†é•œ
- æ–°å¢ç©ºç™½åˆ†é•œ
- äº¤æ¢åˆ†é•œä½ç½®

### 4.2 å½±å“é¡µé¢
- `/dashboard/youtube/prompts/[projectId]` - æç¤ºè¯ç¼–è¾‘é¡µé¢

### 4.3 UI è®¾è®¡

#### 4.3.1 åˆ†é•œå¡ç‰‡æ“ä½œæŒ‰é’®
ä½ç½®ï¼šæ¯ä¸ªåˆ†é•œå¡ç‰‡å³ä¸Šè§’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ†é•œ #3                    [ğŸ”„] [+] [-] â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ–‡ç”Ÿå›¾æç¤ºè¯                        â”‚ â”‚
â”‚ â”‚ ...                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å›¾ç”Ÿè§†é¢‘æç¤ºè¯                      â”‚ â”‚
â”‚ â”‚ ...                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾æ ‡è¯´æ˜:
ğŸ”„ - äº¤æ¢ä½ç½®ï¼ˆç°è‰²/è“è‰²ï¼‰
+  - æ–°å¢åˆ†é•œï¼ˆç»¿è‰²ï¼‰
-  - åˆ é™¤åˆ†é•œï¼ˆçº¢è‰²ï¼‰
```

#### 4.3.2 åˆ é™¤åˆ†é•œç¡®è®¤å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¡®è®¤åˆ é™¤åˆ†é•œ                        [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¡®å®šè¦åˆ é™¤åˆ†é•œ #3 å—ï¼Ÿ                  â”‚
â”‚                                         â”‚
â”‚ æç¤ºè¯é¢„è§ˆ:                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ–‡ç”Ÿå›¾: [ä¸»ä½“]åŠ¨ä½œ:è§’è‰²A(30å²å¥³æ€§,  â”‚ â”‚
â”‚ â”‚ ç©¿ç´«è‰²ä¸ç»¸ç¤¼æœ)èº«ä½“å‰å€¾å¤±å»å¹³è¡¡...  â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ å›¾ç”Ÿè§†é¢‘: æ…¢åŠ¨ä½œé•œå¤´,è§’è‰²Aèº«ä½“å‰å€¾  â”‚ â”‚
â”‚ â”‚ æŠ“ç©º,ä¸€æ¡å‘å…‰çš„è“å®çŸ³é¡¹é“¾ä»ç”»é¢...  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ âš ï¸ åˆ é™¤åï¼Œåç»­åˆ†é•œå°†é‡æ–°ç¼–å·           â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç¡®è®¤åˆ é™¤]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.3 æ–°å¢åˆ†é•œå¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–°å¢åˆ†é•œ                            [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åœ¨åˆ†é•œ #3 çš„å“ªä¸ªä½ç½®æ’å…¥ï¼Ÿ              â”‚
â”‚                                         â”‚
â”‚   â—‹ åœ¨å‰é¢æ’å…¥ (æˆä¸ºæ–°çš„ #3)            â”‚
â”‚   â— åœ¨åé¢æ’å…¥ (æˆä¸ºæ–°çš„ #4)            â”‚
â”‚                                         â”‚
â”‚ è¯´æ˜: æ–°åˆ†é•œå°†ä¸ºç©ºç™½ï¼Œéœ€æ‰‹åŠ¨å¡«å†™æç¤ºè¯  â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç¡®è®¤æ’å…¥]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.4 äº¤æ¢ä½ç½®å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äº¤æ¢åˆ†é•œä½ç½®                        [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å°†åˆ†é•œ #3 ä¸å“ªä¸ªåˆ†é•œäº¤æ¢ä½ç½®ï¼Ÿ          â”‚
â”‚                                         â”‚
â”‚ ç›®æ ‡åˆ†é•œ: [é€‰æ‹©åˆ†é•œ â–¼]                  â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚           â”‚ åˆ†é•œ #1             â”‚       â”‚
â”‚           â”‚ åˆ†é•œ #2             â”‚       â”‚
â”‚           â”‚ åˆ†é•œ #4             â”‚       â”‚
â”‚           â”‚ åˆ†é•œ #5             â”‚       â”‚
â”‚           â”‚ ...                 â”‚       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç¡®è®¤äº¤æ¢]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 API è°ƒç”¨

```typescript
// src/lib/api/youtube.ts æ–°å¢

// åˆ é™¤åˆ†é•œ
export async function deleteStoryboard(
  projectId: string,
  index: number
): Promise<DeleteStoryboardResponse>

// æ–°å¢åˆ†é•œ
export async function addStoryboard(
  projectId: string,
  position: number,
  insertType: 'before' | 'after'
): Promise<AddStoryboardResponse>

// äº¤æ¢åˆ†é•œä½ç½®
export async function swapStoryboards(
  projectId: string,
  indexA: number,
  indexB: number
): Promise<SwapStoryboardsResponse>
```

### 4.5 ç±»å‹å®šä¹‰

```typescript
// src/types/youtube.ts æ–°å¢

export interface DeleteStoryboardResponse {
  success: boolean;
  deleted_index: number;
  new_storyboard_count: number;
  message: string;
}

export interface AddStoryboardResponse {
  success: boolean;
  new_index: number;
  new_storyboard_count: number;
  storyboard: Storyboard;
}

export interface SwapStoryboardsResponse {
  success: boolean;
  swapped: [number, number];
  message: string;
}
```

---

## äº”ã€é¡¹ç›®å¤åˆ¶åŠŸèƒ½

### 5.1 åŠŸèƒ½æ¦‚è¿°

æ”¯æŒå¤åˆ¶ç°æœ‰é¡¹ç›®ï¼Œç”¨äºå¾®è°ƒæˆ–å¤§æ”¹å‰§æœ¬ã€‚

### 5.2 å½±å“é¡µé¢
- `/dashboard/youtube/projects` - é¡¹ç›®åˆ—è¡¨é¡µé¢
- `/dashboard/youtube/project/[projectId]` - é¡¹ç›®è¯¦æƒ…é¡µé¢

### 5.3 UI è®¾è®¡

#### 5.3.1 å¤åˆ¶æŒ‰é’®ä½ç½®
- é¡¹ç›®åˆ—è¡¨ï¼šé¡¹ç›®å¡ç‰‡æ“ä½œèœå•ä¸­
- é¡¹ç›®è¯¦æƒ…ï¼šé¡µé¢å¤´éƒ¨æ“ä½œæŒ‰é’®

#### 5.3.2 å¤åˆ¶é¡¹ç›®å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤åˆ¶é¡¹ç›®                            [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–°é¡¹ç›®åç§°:                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å–„æ¶å¾ªç¯ç±»å‹ - å‰¯æœ¬                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ å¤åˆ¶å†…å®¹:                               â”‚
â”‚ âœ“ é¡¹ç›®åç§°å’Œ YouTube URL                â”‚
â”‚ âœ“ æ‰€æœ‰æç¤ºè¯å†å²ç‰ˆæœ¬                    â”‚
â”‚ âœ“ ä¸»ä½“æ˜ å°„é…ç½®                          â”‚
â”‚ âœ“ å›¾ç‰‡ç”Ÿæˆæ¯”ä¾‹è®¾ç½®                      â”‚
â”‚                                         â”‚
â”‚ ä¸å¤åˆ¶:                                 â”‚
â”‚ âœ— å·²ç”Ÿæˆçš„å›¾ç‰‡                          â”‚
â”‚ âœ— å·²ç”Ÿæˆçš„è§†é¢‘                          â”‚
â”‚                                         â”‚
â”‚              [å–æ¶ˆ]  [ç¡®è®¤å¤åˆ¶]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 API è°ƒç”¨

```typescript
// src/lib/api/youtube.ts æ–°å¢

// å¤åˆ¶é¡¹ç›®
export async function copyProject(
  projectId: string,
  newName: string
): Promise<ProjectResponse>
```

---

## å…­ã€å›¾ç‰‡ç”Ÿæˆæ¯”ä¾‹è®¾ç½®

### 6.1 åŠŸèƒ½æ¦‚è¿°

æ”¯æŒè®¾ç½®é¡¹ç›®çš„å›¾ç‰‡ç”Ÿæˆæ¯”ä¾‹ï¼Œå½±å“æ‰€æœ‰åˆ†é•œçš„å›¾ç‰‡ç”Ÿæˆã€‚

### 6.2 å½±å“é¡µé¢
- `/dashboard/youtube/generate/[projectId]` - å›¾ç‰‡ç”Ÿæˆé¡µé¢
- `/dashboard/youtube/project/[projectId]` - é¡¹ç›®è¯¦æƒ…é¡µé¢ï¼ˆå¯é€‰ï¼‰

### 6.3 UI è®¾è®¡

#### 6.3.1 æ¯”ä¾‹é€‰æ‹©å™¨
ä½ç½®ï¼šå›¾ç‰‡ç”Ÿæˆé¡µé¢å¤´éƒ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† å›¾ç‰‡ç”Ÿæˆ                                              â”‚
â”‚    å…± 15 ä¸ªåˆ†é•œ                                         â”‚
â”‚                                                         â”‚
â”‚    å›¾ç‰‡æ¯”ä¾‹: [ç«–å± 9:16 â–¼]                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚ â— ç«–å± 9:16     â”‚                        â”‚
â”‚              â”‚ â—‹ æ¨ªå± 16:9     â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 6.3.2 æ¯”ä¾‹é¢„è§ˆå›¾æ ‡
åœ¨é€‰æ‹©å™¨æ—è¾¹æ˜¾ç¤ºæ¯”ä¾‹ç¤ºæ„å›¾ï¼š

```
ç«–å± 9:16:  â”Œâ”€â”€â”     æ¨ªå± 16:9:  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  â”‚                 â”‚        â”‚
            â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚  â”‚
            â””â”€â”€â”˜
```

### 6.4 æ•°æ®å­˜å‚¨

æ¯”ä¾‹è®¾ç½®ä¿å­˜åœ¨é¡¹ç›® JSONB çš„ `aspect_ratio` å­—æ®µï¼š
- é»˜è®¤å€¼ï¼š`9:16`
- å¯é€‰å€¼ï¼š`9:16` | `16:9`

### 6.5 API è°ƒç”¨ä¿®æ”¹

```typescript
// æ›´æ–°é¡¹ç›®æ¯”ä¾‹è®¾ç½®
await updateProject(projectId, {
  aspect_ratio: '16:9'
});

// ç”Ÿæˆå›¾ç‰‡æ—¶ä¼ é€’æ¯”ä¾‹å‚æ•°
await generateImage(projectId, {
  storyboard_index: 0,
  character_images: [...],
  aspect_ratio: '9:16'  // å¯é€‰ï¼Œé»˜è®¤ä»é¡¹ç›®é…ç½®è¯»å–
});
```

### 6.6 ç±»å‹å®šä¹‰

```typescript
// src/types/youtube.ts æ–°å¢

export type AspectRatio = '9:16' | '16:9';

// ä¿®æ”¹ GenerateImageRequest
export interface GenerateImageRequest {
  storyboard_index: number;
  character_images?: string[];
  aspect_ratio?: AspectRatio;  // æ–°å¢
}
```

---

## ä¸ƒã€ç»„ä»¶æ”¹é€ æ¸…å•

### 7.1 éœ€è¦ä¿®æ”¹çš„ç»„ä»¶

| ç»„ä»¶è·¯å¾„ | æ”¹é€ å†…å®¹ |
|----------|----------|
| `src/app/dashboard/youtube/settings/page.tsx` | ä¸»ä½“åº“ç®¡ç†æ”¹ä¸ºè°ƒç”¨åç«¯ API |
| `src/app/dashboard/youtube/prompts/[projectId]/page.tsx` | ç‰ˆæœ¬ç®¡ç†ã€åˆ†é•œå¢åˆ æ”¹ |
| `src/app/dashboard/youtube/generate/[projectId]/page.tsx` | æ¯”ä¾‹é€‰æ‹©å™¨ |
| `src/app/dashboard/youtube/projects/page.tsx` | å¤åˆ¶é¡¹ç›®æŒ‰é’® |
| `src/components/youtube/project-card.tsx` | å¤åˆ¶é¡¹ç›®èœå•é¡¹ |
| `src/components/youtube/global-subject-card.tsx` | é€‚é…æ–°çš„ Subject ç±»å‹ |

### 7.2 éœ€è¦æ–°å¢çš„ç»„ä»¶

| ç»„ä»¶è·¯å¾„ | åŠŸèƒ½ |
|----------|------|
| `src/components/youtube/version-selector.tsx` | æç¤ºè¯ç‰ˆæœ¬é€‰æ‹©å™¨ |
| `src/components/youtube/continue-dialog.tsx` | ç»§ç»­å¯¹è¯å¼¹çª— |
| `src/components/youtube/regenerate-dialog.tsx` | é‡æ–°ç”Ÿæˆç¡®è®¤å¼¹çª— |
| `src/components/youtube/delete-storyboard-dialog.tsx` | åˆ é™¤åˆ†é•œç¡®è®¤å¼¹çª— |
| `src/components/youtube/add-storyboard-dialog.tsx` | æ–°å¢åˆ†é•œå¼¹çª— |
| `src/components/youtube/swap-storyboard-dialog.tsx` | äº¤æ¢åˆ†é•œå¼¹çª— |
| `src/components/youtube/copy-project-dialog.tsx` | å¤åˆ¶é¡¹ç›®å¼¹çª— |
| `src/components/youtube/aspect-ratio-selector.tsx` | å›¾ç‰‡æ¯”ä¾‹é€‰æ‹©å™¨ |

### 7.3 éœ€è¦ä¿®æ”¹çš„ API æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | æ”¹é€ å†…å®¹ |
|----------|----------|
| `src/lib/api/youtube.ts` | æ–°å¢æ‰€æœ‰æ–°æ¥å£è°ƒç”¨å‡½æ•° |
| `src/types/youtube.ts` | æ–°å¢æ‰€æœ‰æ–°ç±»å‹å®šä¹‰ |

### 7.4 å¯åˆ é™¤çš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | åŸå›  |
|----------|------|
| `src/lib/subject-config.ts` | IndexedDB ç›¸å…³ä»£ç ä¸å†éœ€è¦ï¼ˆæˆ–é‡æ„ä¸ºçº¯å·¥å…·å‡½æ•°ï¼‰ |
| `src/lib/character-config.ts` | å·²è¢« subject-config æ›¿ä»£ï¼Œå¯åˆå¹¶æˆ–åˆ é™¤ |

---

## å…«ã€å›½é™…åŒ–æ›´æ–°

### 8.1 æ–°å¢ç¿»è¯‘ Key

```json
// src/locales/zh.json æ–°å¢
{
  "youtube": {
    "version": {
      "current": "å½“å‰ç‰ˆæœ¬",
      "switch": "åˆ‡æ¢ç‰ˆæœ¬",
      "continue": "ç»§ç»­å¯¹è¯",
      "regenerate": "é‡æ–°ç”Ÿæˆ",
      "history": "å†å²ç‰ˆæœ¬"
    },
    "storyboard": {
      "add": "æ–°å¢åˆ†é•œ",
      "delete": "åˆ é™¤åˆ†é•œ",
      "swap": "äº¤æ¢ä½ç½®",
      "insertBefore": "åœ¨å‰é¢æ’å…¥",
      "insertAfter": "åœ¨åé¢æ’å…¥",
      "confirmDelete": "ç¡®å®šè¦åˆ é™¤åˆ†é•œ #{index} å—ï¼Ÿ",
      "deleteWarning": "åˆ é™¤åï¼Œåç»­åˆ†é•œå°†é‡æ–°ç¼–å·"
    },
    "project": {
      "copy": "å¤åˆ¶é¡¹ç›®",
      "copySuccess": "é¡¹ç›®å¤åˆ¶æˆåŠŸ",
      "newName": "æ–°é¡¹ç›®åç§°"
    },
    "aspectRatio": {
      "label": "å›¾ç‰‡æ¯”ä¾‹",
      "portrait": "ç«–å± 9:16",
      "landscape": "æ¨ªå± 16:9"
    },
    "subject": {
      "uploadLimit": "å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 5MB"
    }
  }
}
```

```json
// src/locales/en.json æ–°å¢
{
  "youtube": {
    "version": {
      "current": "Current Version",
      "switch": "Switch Version",
      "continue": "Continue Conversation",
      "regenerate": "Regenerate",
      "history": "Version History"
    },
    "storyboard": {
      "add": "Add Storyboard",
      "delete": "Delete Storyboard",
      "swap": "Swap Position",
      "insertBefore": "Insert Before",
      "insertAfter": "Insert After",
      "confirmDelete": "Are you sure you want to delete storyboard #{index}?",
      "deleteWarning": "Subsequent storyboards will be renumbered"
    },
    "project": {
      "copy": "Copy Project",
      "copySuccess": "Project copied successfully",
      "newName": "New Project Name"
    },
    "aspectRatio": {
      "label": "Aspect Ratio",
      "portrait": "Portrait 9:16",
      "landscape": "Landscape 16:9"
    },
    "subject": {
      "uploadLimit": "Image size cannot exceed 5MB"
    }
  }
}
```

---

## ä¹ã€å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½
1. ç±»å‹å®šä¹‰æ›´æ–° (`src/types/youtube.ts`)
2. API å®¢æˆ·ç«¯æ›´æ–° (`src/lib/api/youtube.ts`)

### ç¬¬äºŒé˜¶æ®µï¼šä¸»ä½“åº“æœåŠ¡å™¨åŒ–
1. Settings é¡µé¢æ”¹é€ 
2. æç¤ºè¯ç¼–è¾‘é¡µé¢ä¸»ä½“æ˜ å°„æ”¹é€ 

### ç¬¬ä¸‰é˜¶æ®µï¼šæç¤ºè¯ç‰ˆæœ¬ç®¡ç†
1. ç‰ˆæœ¬é€‰æ‹©å™¨ç»„ä»¶
2. ç»§ç»­å¯¹è¯åŠŸèƒ½
3. é‡æ–°ç”ŸæˆåŠŸèƒ½

### ç¬¬å››é˜¶æ®µï¼šåˆ†é•œç®¡ç†
1. åˆ é™¤åˆ†é•œåŠŸèƒ½
2. æ–°å¢åˆ†é•œåŠŸèƒ½
3. äº¤æ¢ä½ç½®åŠŸèƒ½

### ç¬¬äº”é˜¶æ®µï¼šå…¶ä»–åŠŸèƒ½
1. é¡¹ç›®å¤åˆ¶åŠŸèƒ½
2. å›¾ç‰‡æ¯”ä¾‹è®¾ç½®åŠŸèƒ½
